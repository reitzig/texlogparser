version: 2

jobs:
  test-2.3:
    docker:
      - image: circleci/ruby:2.3
    steps:
      - checkout
      - run: gem update --system
      - run: gem install bundler
      - run: bundle install
      - run: rake test
  test-2.4:
      docker:
        - image: circleci/ruby:2.4
      steps:
        - checkout
        - run: gem update --system
        - run: gem install bundler
        - run: bundle install
        - run: rake test
  test-2.5:
      docker:
        - image: circleci/ruby:2.5
      steps:
        - checkout
        - run: gem update --system
        - run: gem install bundler
        - run: bundle install
        - run: rake test
  build:
      docker:
        - image: circleci/ruby:2.5
      steps:
        - checkout
        - run: gem update --system
        - run: gem install bundler
        - run: bundle install
        - run: gem build

workflows:
  version: 2
  test:
    jobs:
      - test-2.3
      - test-2.4
      - test-2.5
      - build:
          requires:
            - test-2.3
            - test-2.4
            - test-2.5